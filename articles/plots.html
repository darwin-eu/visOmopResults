<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Plotting tools • visOmopResults</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plotting tools">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">visOmopResults</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0.900</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/formatFunctions.html">format functions</a></li>
    <li><a class="dropdown-item" href="../articles/plots.html">Plotting tools</a></li>
    <li><a class="dropdown-item" href="../articles/splitAndUnite.html">split and unite functions</a></li>
    <li><a class="dropdown-item" href="../articles/tidy.html">tidy</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/darwin-eu/visOmopResults/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plotting tools</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/darwin-eu/visOmopResults/blob/main/vignettes/plots.Rmd" class="external-link"><code>vignettes/plots.Rmd</code></a></small>
      <div class="d-none name"><code>plots.Rmd</code></div>
    </div>

    
    
<p><strong>visOmopResults</strong> offer some plotting tools that can be
very useful. These tools are useful to plot either
<code>&lt;summarised_result&gt;</code> dataset or a usual
<code>&lt;data.frame&gt;</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://darwin-eu.github.io/visOmopResults/">visOmopResults</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="plotting-with-a-summarised_result">Plotting with a <code>&lt;summarised_result&gt;</code><a class="anchor" aria-label="anchor" href="#plotting-with-a-summarised_result"></a>
</h2>
<p>For the purpose of this vignette we will turn summarise the dataset
penguins from the palmerpenguins package using
<code><a href="https://darwin-eu-dev.github.io/PatientProfiles/reference/summariseResult.html" class="external-link">PatientProfiles::summariseResult()</a></code></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://darwin-eu-dev.github.io/PatientProfiles/" class="external-link">PatientProfiles</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://allisonhorst.github.io/palmerpenguins/" class="external-link">palmerpenguins</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span></span>
<span><span class="va">summariseIsland</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">island</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">penguins</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">island</span> <span class="op">==</span> <span class="va">.env</span><span class="op">$</span><span class="va">island</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://darwin-eu-dev.github.io/PatientProfiles/reference/summariseResult.html" class="external-link">summariseResult</a></span><span class="op">(</span></span>
<span>      group <span class="op">=</span> <span class="st">"species"</span>,</span>
<span>      includeOverallGroup <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>      strata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"year"</span>, <span class="st">"sex"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"year"</span>, <span class="st">"sex"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>        <span class="st">"bill_length_mm"</span>, <span class="st">"bill_depth_mm"</span>, <span class="st">"flipper_length_mm"</span>, <span class="st">"body_mass_g"</span>, </span>
<span>        <span class="st">"sex"</span><span class="op">)</span>,</span>
<span>      estimates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>        <span class="st">"median"</span>, <span class="st">"q25"</span>, <span class="st">"q75"</span>, <span class="st">"min"</span>, <span class="st">"max"</span>, <span class="st">"count_missing"</span>, <span class="st">"count"</span>, </span>
<span>        <span class="st">"percentage"</span>, <span class="st">"density"</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cdm_name <span class="op">=</span> <span class="va">island</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">penguinsSummary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://darwin-eu-dev.github.io/omopgenerics/reference/bind.html" class="external-link">bind</a></span><span class="op">(</span></span>
<span>  <span class="fu">summariseIsland</span><span class="op">(</span><span class="st">"Torgersen"</span><span class="op">)</span>, </span>
<span>  <span class="fu">summariseIsland</span><span class="op">(</span><span class="st">"Biscoe"</span><span class="op">)</span>, </span>
<span>  <span class="fu">summariseIsland</span><span class="op">(</span><span class="st">"Dream"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="plotting-principles">Plotting principles<a class="anchor" aria-label="anchor" href="#plotting-principles"></a>
</h3>
<p>Although the input of a visOmopResult plot function can be a
<code>&lt;summarised_result&gt;</code> when referring to inputs, we will
use the columns shown in its tidy format:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tidyColumns.html">tidyColumns</a></span><span class="op">(</span><span class="va">penguinsSummary</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "cdm_name"        "species"         "year"            "sex"            </span></span>
<span><span class="co">#&gt;  [5] "variable_name"   "variable_level"  "count"           "median"         </span></span>
<span><span class="co">#&gt;  [9] "q25"             "q75"             "min"             "max"            </span></span>
<span><span class="co">#&gt; [13] "count_missing"   "density_x"       "density_y"       "percentage"     </span></span>
<span><span class="co">#&gt; [17] "result_type"     "package_name"    "package_version"</span></span></code></pre></div>
<p>And not the column names seen in the
<code>&lt;summarised_result&gt;</code> format:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">penguinsSummary</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "result_id"        "cdm_name"         "group_name"       "group_level"     </span></span>
<span><span class="co">#&gt;  [5] "strata_name"      "strata_level"     "variable_name"    "variable_level"  </span></span>
<span><span class="co">#&gt;  [9] "estimate_name"    "estimate_type"    "estimate_value"   "additional_name" </span></span>
<span><span class="co">#&gt; [13] "additional_level"</span></span></code></pre></div>
<p>That’s the most important thing to be aware of, otherwise populating
arguments becomes a bit tricky.</p>
<p>We should always subset the <code>&lt;summarised_result&gt;</code> to
the variable_name of interest before calling the plotting functions. It
is not advised to combine results of different variables if they don’t
share common estimates that we want to plot as in the tidy form NAs will
be created.</p>
</div>
<div class="section level3">
<h3 id="scatter-plot">Scatter plot<a class="anchor" aria-label="anchor" href="#scatter-plot"></a>
</h3>
<p>We can create simple scatter plots using the
<code>plotScatter()</code> let’s see some examples:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguinsSummary</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">variable_name</span> <span class="op">==</span> <span class="st">"bill_depth_mm"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/filterStrata.html">filterStrata</a></span><span class="op">(</span><span class="va">year</span> <span class="op">!=</span> <span class="st">"overall"</span>, <span class="va">sex</span> <span class="op">==</span> <span class="st">"overall"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/scatterPlot.html">scatterPlot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"year"</span>, </span>
<span>    y <span class="op">=</span> <span class="st">"median"</span>,</span>
<span>    line <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    point <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    ribbon <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    facet <span class="op">=</span> <span class="st">"cdm_name"</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"species"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="plots_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguinsSummary</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">variable_name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bill_length_mm"</span>, <span class="st">"bill_depth_mm"</span><span class="op">)</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/filterStrata.html">filterStrata</a></span><span class="op">(</span><span class="va">year</span> <span class="op">==</span> <span class="st">"overall"</span>, <span class="va">sex</span> <span class="op">==</span> <span class="st">"overall"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/filterGroup.html">filterGroup</a></span><span class="op">(</span><span class="va">species</span> <span class="op">!=</span> <span class="st">"overall"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/scatterPlot.html">scatterPlot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"density_x"</span>, </span>
<span>    y <span class="op">=</span> <span class="st">"density_y"</span>,</span>
<span>    line <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    point <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    ribbon <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    facet <span class="op">=</span> <span class="va">cdm_name</span> <span class="op">~</span> <span class="va">variable_name</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"species"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">cdm_name</span> <span class="op">~</span> <span class="va">variable_name</span>, scales <span class="op">=</span> <span class="st">"free_x"</span><span class="op">)</span></span></code></pre></div>
<p><img src="plots_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguinsSummary</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">variable_name</span> <span class="op">==</span> <span class="st">"flipper_length_mm"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/filterStrata.html">filterStrata</a></span><span class="op">(</span><span class="va">year</span> <span class="op">!=</span> <span class="st">"overall"</span>, <span class="va">sex</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"female"</span>, <span class="st">"male"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/scatterPlot.html">scatterPlot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"year"</span>, <span class="st">"sex"</span><span class="op">)</span>, </span>
<span>    y <span class="op">=</span> <span class="st">"median"</span>,</span>
<span>    ymin <span class="op">=</span> <span class="st">"q25"</span>,</span>
<span>    ymax <span class="op">=</span> <span class="st">"q75"</span>,</span>
<span>    line <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>    point <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    ribbon <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    facet <span class="op">=</span> <span class="va">cdm_name</span> <span class="op">~</span> <span class="va">species</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"sex"</span>,</span>
<span>    group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"year"</span>, <span class="st">"sex"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Flipper length (mm)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="plots_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguinsSummary</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">variable_name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"flipper_length_mm"</span>, <span class="st">"bill_length_mm"</span>, <span class="st">"bill_depth_mm"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/filterStrata.html">filterStrata</a></span><span class="op">(</span><span class="va">sex</span> <span class="op">==</span> <span class="st">"overall"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/scatterPlot.html">scatterPlot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"year"</span>, </span>
<span>    y <span class="op">=</span> <span class="st">"median"</span>,</span>
<span>    ymin <span class="op">=</span> <span class="st">"min"</span>,</span>
<span>    ymax <span class="op">=</span> <span class="st">"max"</span>,</span>
<span>    line <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>    point <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    ribbon <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    facet <span class="op">=</span> <span class="va">cdm_name</span> <span class="op">~</span> <span class="va">species</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"variable_name"</span>,</span>
<span>    group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"variable_name"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="plots_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="bar-plot">Bar plot<a class="anchor" aria-label="anchor" href="#bar-plot"></a>
</h3>
<p>Let’s create some simple bar plots:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguinsSummary</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">variable_name</span> <span class="op">==</span> <span class="st">"number records"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/filterGroup.html">filterGroup</a></span><span class="op">(</span><span class="va">species</span> <span class="op">!=</span> <span class="st">"overall"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/filterStrata.html">filterStrata</a></span><span class="op">(</span><span class="va">sex</span> <span class="op">!=</span> <span class="st">"overall"</span>, <span class="va">year</span> <span class="op">!=</span> <span class="st">"overall"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/barPlot.html">barPlot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"year"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"count"</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"sex"</span>,</span>
<span>    facet <span class="op">=</span> <span class="va">cdm_name</span> <span class="op">~</span> <span class="va">species</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="plots_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="box-plot">Box plot<a class="anchor" aria-label="anchor" href="#box-plot"></a>
</h3>
<p>Let’s create some box plots of their body mass:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguinsSummary</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">variable_name</span> <span class="op">==</span> <span class="st">"body_mass_g"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/boxPlot.html">boxPlot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"year"</span>, facet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cdm_name"</span>, <span class="st">"species"</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"sex"</span><span class="op">)</span></span></code></pre></div>
<p><img src="plots_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
<p>We can specify how we want to facet using a formula:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguinsSummary</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">variable_name</span> <span class="op">==</span> <span class="st">"body_mass_g"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/boxPlot.html">boxPlot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"year"</span>, facet <span class="op">=</span> <span class="va">cdm_name</span> <span class="op">~</span> <span class="va">species</span>, colour <span class="op">=</span> <span class="st">"sex"</span><span class="op">)</span></span></code></pre></div>
<p><img src="plots_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<p>Arguments before <code>~</code> specify the rows, and arguments after
the columns, see another example faceting also by sex in the columns.
And in this case colouring by year:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguinsSummary</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">variable_name</span> <span class="op">==</span> <span class="st">"body_mass_g"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/filterGroup.html">filterGroup</a></span><span class="op">(</span><span class="va">species</span> <span class="op">!=</span> <span class="st">"overall"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/filterStrata.html">filterStrata</a></span><span class="op">(</span><span class="va">sex</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"female"</span>, <span class="st">"male"</span><span class="op">)</span>, <span class="va">year</span> <span class="op">!=</span> <span class="st">"overall"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/boxPlot.html">boxPlot</a></span><span class="op">(</span>facet <span class="op">=</span> <span class="va">cdm_name</span> <span class="op">~</span> <span class="va">species</span> <span class="op">+</span> <span class="va">sex</span>, colour <span class="op">=</span> <span class="st">"year"</span><span class="op">)</span></span></code></pre></div>
<p><img src="plots_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
<p>Note that as we didnt specify x there is no levels in the x axis, but
box plots are produced anyway.</p>
</div>
</div>
<div class="section level2">
<h2 id="plotting-with-a-data-frame">Plotting with a <code>&lt;data.frame&gt;</code><a class="anchor" aria-label="anchor" href="#plotting-with-a-data-frame"></a>
</h2>
<p>Plotting functions can also be used with a normal
<code>&lt;data.frame&gt;</code>. In this case we will use the tidy
format of <code>penguinsSummary</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguinsTidy</span> <span class="op">&lt;-</span> <span class="va">penguinsSummary</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">estimate_name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"density_x"</span>, <span class="st">"density_y"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># remove density for simplicity</span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">penguinsTidy</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 720</span></span>
<span><span class="co">#&gt; Columns: 17</span></span>
<span><span class="co">#&gt; $ cdm_name        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Torgersen", "Torgersen", "Torgersen", "Torgersen", "T…</span></span>
<span><span class="co">#&gt; $ species         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "overall", "overall", "overall", "overall", "overall",…</span></span>
<span><span class="co">#&gt; $ year            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "overall", "overall", "overall", "overall", "overall",…</span></span>
<span><span class="co">#&gt; $ sex             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "overall", "overall", "overall", "overall", "overall",…</span></span>
<span><span class="co">#&gt; $ variable_name   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "number records", "bill_length_mm", "bill_depth_mm", "…</span></span>
<span><span class="co">#&gt; $ variable_level  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> NA, NA, NA, NA, NA, "female", "male", NA, NA, NA, NA, …</span></span>
<span><span class="co">#&gt; $ count           <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 52, NA, NA, NA, NA, 24, 23, 5, 20, 16, 16, NA, NA, NA,…</span></span>
<span><span class="co">#&gt; $ median          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> NA, 38, 18, 191, 3700, NA, NA, NA, NA, NA, NA, 38, 38,…</span></span>
<span><span class="co">#&gt; $ q25             <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> NA, 36, 17, 187, 3338, NA, NA, NA, NA, NA, NA, 37, 35,…</span></span>
<span><span class="co">#&gt; $ q75             <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> NA, 41, 19, 195, 4000, NA, NA, NA, NA, NA, NA, 39, 41,…</span></span>
<span><span class="co">#&gt; $ min             <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> NA, 33, 15, 176, 2900, NA, NA, NA, NA, NA, NA, 34, 33,…</span></span>
<span><span class="co">#&gt; $ max             <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> NA, 46, 21, 210, 4700, NA, NA, NA, NA, NA, NA, 46, 45,…</span></span>
<span><span class="co">#&gt; $ count_missing   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> NA, 1, 1, 1, 1, NA, NA, NA, NA, NA, NA, 1, 0, 0, 1, 0,…</span></span>
<span><span class="co">#&gt; $ percentage      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> NA, NA, NA, NA, NA, 46.153846, 44.230769, 9.615385, NA…</span></span>
<span><span class="co">#&gt; $ result_type     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "summarise_table", "summarise_table", "summarise_table…</span></span>
<span><span class="co">#&gt; $ package_name    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "PatientProfiles", "PatientProfiles", "PatientProfiles…</span></span>
<span><span class="co">#&gt; $ package_version <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "1.2.0", "1.2.0", "1.2.0", "1.2.0", "1.2.0", "1.2.0", …</span></span></code></pre></div>
<p>That as it can be seen is a normal data.frame:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguinsTidy</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "tbl_df"     "tbl"        "data.frame"</span></span></code></pre></div>
<p>We can then do some custom plotting, for example replicating the last
plot but from the tidy format:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguinsTidy</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">variable_name</span> <span class="op">==</span> <span class="st">"body_mass_g"</span>,</span>
<span>    <span class="va">species</span> <span class="op">!=</span> <span class="st">"overall"</span>,</span>
<span>    <span class="va">sex</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"female"</span>, <span class="st">"male"</span><span class="op">)</span>,</span>
<span>    <span class="va">year</span> <span class="op">!=</span> <span class="st">"overall"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/boxPlot.html">boxPlot</a></span><span class="op">(</span>facet <span class="op">=</span> <span class="va">cdm_name</span> <span class="op">~</span> <span class="va">species</span> <span class="op">+</span> <span class="va">sex</span>, colour <span class="op">=</span> <span class="st">"year"</span><span class="op">)</span></span></code></pre></div>
<p><img src="plots_files/figure-html/unnamed-chunk-15-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="custom-plotting">Custom plotting<a class="anchor" aria-label="anchor" href="#custom-plotting"></a>
</h2>
<p>The tidy format is very useful to apply any other custom ggplot2
function that we may be interested on:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">penguinsSummary</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">variable_name</span> <span class="op">==</span> <span class="st">"number records"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">sex</span>, fill <span class="op">=</span> <span class="va">count</span>, label <span class="op">=</span> <span class="va">count</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span>trans <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">cdm_name</span> <span class="op">~</span> <span class="va">species</span><span class="op">)</span></span></code></pre></div>
<p><img src="plots_files/figure-html/unnamed-chunk-16-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="combine-with-ggplot2">Combine with <code>ggplot2</code><a class="anchor" aria-label="anchor" href="#combine-with-ggplot2"></a>
</h2>
<p>The plotting functions are a wrapper around the ggplot2 package,
outputs of the plotting functions can be later customised with ggplot2
and similar tools. For example we can use <code><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggplot2::labs()</a></code>
to change the labels and <code><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">ggplot2::theme()</a></code> to move the
location of the legend.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguinsSummary</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">group_level</span> <span class="op">!=</span> <span class="st">"overall"</span>,</span>
<span>    <span class="va">strata_name</span> <span class="op">==</span> <span class="st">"year &amp;&amp;&amp; sex"</span>,</span>
<span>    <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"NA"</span>, <span class="va">strata_level</span><span class="op">)</span>,</span>
<span>    <span class="va">variable_name</span> <span class="op">==</span> <span class="st">"body_mass_g"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/boxPlot.html">boxPlot</a></span><span class="op">(</span>facet <span class="op">=</span> <span class="va">cdm_name</span> <span class="op">~</span> <span class="va">species</span> <span class="op">+</span> <span class="va">sex</span>, colour <span class="op">=</span> <span class="st">"year"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6500</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"My custom x label"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></code></pre></div>
<p><img src="plots_files/figure-html/unnamed-chunk-17-1.png" width="672"></p>
<p>You can also use <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggplot2::ggsave()</a></code> to later save one of
this plots into ‘.png’ file.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span></span>
<span>  <span class="st">"figure8.png"</span>, plot <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/last_plot.html" class="external-link">last_plot</a></span><span class="op">(</span><span class="op">)</span>, device <span class="op">=</span> <span class="st">"png"</span>, width <span class="op">=</span> <span class="fl">15</span>, height <span class="op">=</span> <span class="fl">12</span>, </span>
<span>  units <span class="op">=</span> <span class="st">"cm"</span>, dpi <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="combine-with-plotly">Combine with <code>plotly</code><a class="anchor" aria-label="anchor" href="#combine-with-plotly"></a>
</h2>
<p>Although the package currently does not provide any plotly
functionality ggplots can be easily converted to
<code>&lt;plotly&gt;</code> ones using the function
<code><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html" class="external-link">plotly::ggplotly()</a></code>. This can make the interactivity of some
plots better.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Martí Català, Núria Mercadé-Besora.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
